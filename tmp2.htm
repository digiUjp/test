<!DOCTYPE html>
<html>

<body>
    <script>
        o = console.log
        const speak = (word) => {
            o("prepare speak " + word)
            return new Promise((resolve, reject) => {
                window.speechSynthesis.cancel()
                o("speak " + word)
                const uttr = new SpeechSynthesisUtterance(word);
                uttr.lang = 'en-US'
                uttr.onend = resolve   
                uttr.onerror = (event) => {
                    console.error("SpeechSynthesis Error:", event.error)
                    reject(event)
                }
                window.speechSynthesis.speak(uttr)
            })
        }
        async function playSequence() {
            try {
                o("0");
                await speak("Hello")
                o("1");
                await speak("World")
                o("2");
            } catch (e) {
                console.error("Sequence failed:", e)
            }
        }
        document.addEventListener('click', () => {
            o("再生を開始します...");
            playSequence()
        }) //, { once: true } 最初の1回だけ実行
    </script>
</body>

</html>
